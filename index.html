<html><head><base href="main.html">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒªã‚¢ãƒ«ã‚µãƒãƒ¼ãƒˆãƒãƒ£ãƒƒãƒˆ</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@300;400;700&display=swap');

  body {
    font-family: 'M PLUS Rounded 1c', sans-serif;
    background-color: #ffe6e6;
    margin: 0;
    padding: 20px;
    color: #5a3d3d;
  }
  .container {
    max-width: 800px;
    margin: 0 auto;
    background-color: #fff5f5;
    border-radius: 30px;
    padding: 30px;
    box-shadow: 0 0 20px rgba(255, 182, 193, 0.5);
  }
  h1, h2 {
    color: #ff69b4;
    text-align: center;
    margin-bottom: 30px;
    text-shadow: 2px 2px 4px rgba(255, 105, 180, 0.3);
  }
  h1 { font-size: 2.5em; }
  h2 { font-size: 2em; }
  label {
    display: block;
    margin-top: 15px;
    color: #ff69b4;
    font-weight: bold;
  }
  select, input[type="text"], input[type="password"], textarea {
    width: 100%;
    padding: 12px;
    margin-top: 5px;
    border: 3px solid #ffb6c1;
    border-radius: 20px;
    box-sizing: border-box;
    font-family: 'M PLUS Rounded 1c', sans-serif;
    color: #5a3d3d;
    background-color: #fff;
    transition: all 0.3s ease;
  }
  select:focus, input:focus, textarea:focus {
    outline: none;
    border-color: #ff69b4;
    box-shadow: 0 0 10px rgba(255, 105, 180, 0.5);
  }
  button {
    background-color: #ff69b4;
    color: white;
    padding: 15px 25px;
    border: none;
    border-radius: 30px;
    cursor: pointer;
    width: 100%;
    margin-top: 20px;
    font-size: 18px;
    font-family: 'M PLUS Rounded 1c', sans-serif;
    font-weight: bold;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4);
  }
  button:hover {
    background-color: #ff1493;
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(255, 105, 180, 0.6);
  }
  #responseArea, #adminResponseArea, #historyArea {
    margin-top: 30px;
    padding: 20px;
    background-color: #fff0f5;
    border-radius: 20px;
    border: 3px solid #ffb6c1;
  }
  .response {
    margin-bottom: 15px;
    padding: 15px;
    background-color: #fff;
    border-radius: 15px;
    box-shadow: 0 3px 10px rgba(255, 182, 193, 0.3);
  }
  .emoji {
    font-size: 2em;
    margin-right: 10px;
    vertical-align: middle;
  }
  .hidden {
    display: none;
  }
  #deleteHistory {
    background-color: #ff4757;
    margin-top: 10px;
  }
  #deleteHistory:hover {
    background-color: #ff6b81;
  }
  .deleteBtn {
    background-color: #ff4757;
    color: white;
    padding: 5px 10px;
    border: none;
    border-radius: 15px;
    cursor: pointer;
    font-size: 14px;
    margin-left: 10px;
  }
  .deleteBtn:hover {
    background-color: #ff6b81;
  }
</style>
</head>
<body>
<div class="container">
  <h1><span class="emoji">ğŸ’–</span>ãƒªã‚¢ãƒ«ã‚µãƒãƒ¼ãƒˆãƒãƒ£ãƒƒãƒˆ<span class="emoji">ğŸ’–</span></h1>
  
  <form id="loginForm">
    <label for="password">ãƒã‚¸ã‚«ãƒ«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼š</label>
    <input type="password" id="password" required placeholder="ãƒ’ãƒŸãƒ„ã®åˆè¨€è‘‰ã‚’å…¥åŠ›ã—ã¦ã­â™ª">
    <button type="submit">ãƒ­ã‚°ã‚¤ãƒ³<span class="emoji">ğŸ”‘</span></button>
  </form>

  <form id="supportForm" class="hidden">
    <label for="name">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼š</label>
    <input type="text" id="name" required placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’æ•™ãˆã¦ã­â™¡">
    
    <label for="class">ã‚¯ãƒ©ã‚¹ï¼š</label>
    <select id="class" required>
      <option value="">é¸ã‚“ã§ã­â™ª</option>
      <!-- JavaScriptã§ã‚¯ãƒ©ã‚¹ã®é¸æŠè‚¢ã‚’ç”Ÿæˆ -->
    </select>
    
    <label for="number">ãƒ©ãƒƒã‚­ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼š</label>
    <select id="number" required>
      <option value="">é¸ã‚“ã§ã­â™ª</option>
      <!-- JavaScriptã§1ã‹ã‚‰44ã¾ã§ã®é¸æŠè‚¢ã‚’ç”Ÿæˆ -->
    </select>
    
    <label for="situation">ã©ã‚“ãªæ°—æŒã¡ï¼Ÿï¼š</label>
    <select id="situation" required>
      <option value="">é¸ã‚“ã§ã­â™ª</option>
      <option value="åˆ¶ä½œã—ã¦ã„ã‚‹ç‰©ã«ã¤ã„ã¦ç›¸è«‡ã—ãŸã„">ä½œã£ã¦ã‚‹ã‚‚ã®ã«ã¤ã„ã¦ãŠè©±ã—ã—ãŸã„â™ª</option>
      <option value="å›°ã£ãŸã“ã¨ãŒã‚ã£ã¦æ‚©ã‚“ã§ã„ã‚‹">å›°ã£ã¦ã‚‹ã®...åŠ©ã‘ã¦ï½(Â´ï¼›Ï‰ï¼›ï½€)</option>
      <option value="ç‰¹ã«ãªã„ãŒè©±ãŒã—ãŸã„">ç‰¹ã«ãªã„ã‘ã©ã€ä½œå“ã‚’è¦‹ã¦ã»ã—ã„ã€‚â™¡</option>
      <option value="ãã®ä»–">ãã®ä»–ã®ãƒ¯ã‚±ã‚ã‚Šç›¸è«‡â™ª</option>
    </select>
    
    <label for="details">ãŠè©±ã®å†…å®¹ï¼š</label>
    <textarea id="details" rows="4" required placeholder="ã“ã“ã«æ°—æŒã¡ã‚’ãŸãã•ã‚“æ›¸ã„ã¦ã­â™¡"></textarea>
    
    <button type="submit">é€ä¿¡<span class="emoji">âœ¨</span></button>
  </form>
  
  <div id="responseArea" class="hidden">
    <h2><span class="emoji">ğŸ’Œ</span>ãƒãƒ¼ãƒˆãƒ•ãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</h2>
    <!-- è¿”ä¿¡å†…å®¹ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
  </div>

  <div id="adminResponseArea" class="hidden">
    <h2><span class="emoji">ğŸ‘©â€ğŸ«</span>ç®¡ç†è€…è¿”ä¿¡ãƒ•ã‚©ãƒ¼ãƒ </h2>
    <form id="adminForm">
      <label for="adminResponse">è¿”ä¿¡å†…å®¹ï¼š</label>
      <textarea id="adminResponse" rows="4" required placeholder="ã“ã“ã«è¿”ä¿¡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"></textarea>
      <button type="submit">è¿”ä¿¡ã‚’é€ä¿¡<span class="emoji">ğŸ“¤</span></button>
    </form>
  </div>

  <div id="historyArea" class="hidden">
    <h2><span class="emoji">ğŸ“š</span>éå»ã®ã‚„ã‚Šã¨ã‚Š</h2>
    <button id="showHistory">å±¥æ­´ã‚’è¡¨ç¤ºã™ã‚‹<span class="emoji">ğŸ”</span></button>
    <button id="deleteHistory">å±¥æ­´ã‚’å…¨ã¦å‰Šé™¤ã™ã‚‹<span class="emoji">ğŸ—‘ï¸</span></button>
    <div id="historyContent"></div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const loginForm = document.getElementById('loginForm');
  const supportForm = document.getElementById('supportForm');
  const responseArea = document.getElementById('responseArea');
  const adminResponseArea = document.getElementById('adminResponseArea');
  const historyArea = document.getElementById('historyArea');
  const classSelect = document.getElementById('class');
  const numberSelect = document.getElementById('number');

  // ã‚¯ãƒ©ã‚¹ã®é¸æŠè‚¢ã‚’ç”Ÿæˆ
  for (let grade = 1; grade <= 3; grade++) {
    for (let classNum = 1; classNum <= 5; classNum++) {
      const option = document.createElement('option');
      option.value = `${grade}-${classNum}`;
      option.textContent = `${grade}-${classNum} ${getClassEmoji(grade, classNum)}`;
      classSelect.appendChild(option);
    }
  }

  // ãƒ©ãƒƒã‚­ãƒ¼ãƒŠãƒ³ãƒãƒ¼ã®é¸æŠè‚¢ã‚’ç”Ÿæˆ
  for (let i = 1; i <= 44; i++) {
    const option = document.createElement('option');
    option.value = i;
    option.textContent = `${i} ${getNumberEmoji(i)}`;
    numberSelect.appendChild(option);
  }

  loginForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const password = document.getElementById('password').value;
    if (password === 'bijyu') {
      loginForm.classList.add('hidden');
      supportForm.classList.remove('hidden');
      responseArea.classList.remove('hidden');
      adminResponseArea.classList.remove('hidden');
      historyArea.classList.remove('hidden');
    } else {
      alert('ã‚ã‚‰ï¼Ÿ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã†ã¿ãŸã„ã€‚ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ã­â™ª');
    }
  });

  supportForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®åé›†
    const formData = {
      id: Date.now(), // ä¸€æ„ã®IDã‚’ç”Ÿæˆ
      name: document.getElementById('name').value,
      class: document.getElementById('class').value,
      number: document.getElementById('number').value,
      situation: document.getElementById('situation').value,
      details: document.getElementById('details').value,
      timestamp: new Date().toLocaleString()
    };

    // é€ä¿¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    const submittedMessage = `<div class="response">
      <p><strong>${formData.name}ã•ã‚“</strong>ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚</p>
      <p>å†…å®¹ã‚’ç¢ºèªæ¬¡ç¬¬ã€è¿”ä¿¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚</p>
      <p>ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚${getRandomEmoji()}</p>
    </div>`;

    responseArea.innerHTML += submittedMessage;

    // å±¥æ­´ã«ä¿å­˜
    saveToHistory(formData);

    // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
    supportForm.reset();
  });

  // ç®¡ç†è€…ã®è¿”ä¿¡ãƒ•ã‚©ãƒ¼ãƒ 
  const adminForm = document.getElementById('adminForm');
  adminForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const adminResponse = document.getElementById('adminResponse').value;
    
    const responseMessage = `<div class="response">
      <p><strong>å…ˆç”Ÿã‹ã‚‰ã®è¿”ä¿¡ï¼š</strong></p>
      <p>${adminResponse}</p>
    </div>`;

    responseArea.innerHTML += responseMessage;

    // å±¥æ­´ã«ä¿å­˜
    saveToHistory({
      id: Date.now(), // ä¸€æ„ã®IDã‚’ç”Ÿæˆ
      type: 'admin',
      response: adminResponse,
      timestamp: new Date().toLocaleString()
    });

    adminForm.reset();
  });

  // å±¥æ­´ã‚’è¡¨ç¤ºã™ã‚‹ãƒœã‚¿ãƒ³
  const showHistoryBtn = document.getElementById('showHistory');
  showHistoryBtn.addEventListener('click', function() {
    displayHistory();
  });

  // å±¥æ­´ã‚’å…¨ã¦å‰Šé™¤ã™ã‚‹ãƒœã‚¿ãƒ³
  const deleteHistoryBtn = document.getElementById('deleteHistory');
  deleteHistoryBtn.addEventListener('click', function() {
    if (confirm('æœ¬å½“ã«å±¥æ­´ã‚’å…¨ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
      localStorage.removeItem('chatHistory');
      const historyContent = document.getElementById('historyContent');
      historyContent.innerHTML = '<p>å±¥æ­´ãŒå…¨ã¦å‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚</p>';
    }
  });

  function getClassEmoji(grade, classNum) {
    const emojis = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ·', 'ğŸŒ¹', 'ğŸŒ»'];
    return emojis[(grade + classNum) % 5];
  }

  function getNumberEmoji(number) {
    const emojis = ['ğŸ“', 'ğŸŠ', 'ğŸ‹', 'ğŸ', 'ğŸ', 'ğŸ‰', 'ğŸ‡', 'ğŸ’', 'ğŸ‘', 'ğŸ¥'];
    return emojis[number % 10];
  }

  function getRandomEmoji() {
    const emojis = ['ğŸ˜Š', 'ğŸ’–', 'âœ¨', 'ğŸŒŸ', 'ğŸˆ', 'ğŸŒ¸', 'ğŸ€', 'ğŸŒˆ', 'ğŸ­', 'ğŸ¦„'];
    return emojis[Math.floor(Math.random() * emojis.length)];
  }

  function saveToHistory(data) {
    let history = JSON.parse(localStorage.getItem('chatHistory')) || [];
    history.push(data);
    localStorage.setItem('chatHistory', JSON.stringify(history));
  }

  function displayHistory() {
    const historyContent = document.getElementById('historyContent');
    const history = JSON.parse(localStorage.getItem('chatHistory')) || [];
    
    let historyHTML = '';
    history.forEach(item => {
      if (item.type === 'admin') {
        historyHTML += `<div class="response">
          <p><strong>å…ˆç”Ÿã‹ã‚‰ã®è¿”ä¿¡ (${item.timestamp})ï¼š</strong></p>
          <p>${item.response}</p>
          <button class="deleteBtn" data-id="${item.id}">ã“ã®è¨˜éŒ²ã‚’å‰Šé™¤</button>
        </div>`;
      } else {
        historyHTML += `<div class="response">
          <p><strong>${item.name}ã•ã‚“ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (${item.timestamp})ï¼š</strong></p>
          <p>ã‚¯ãƒ©ã‚¹: ${item.class}</p>
          <p>ãƒ©ãƒƒã‚­ãƒ¼ãƒŠãƒ³ãƒãƒ¼: ${item.number}</p>
          <p>çŠ¶æ³: ${item.situation}</p>
          <p>è©³ç´°: ${item.details}</p>
          <button class="deleteBtn" data-id="${item.id}">ã“ã®è¨˜éŒ²ã‚’å‰Šé™¤</button>
        </div>`;
      }
    });

    historyContent.innerHTML = historyHTML || '<p>å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';

    // å€‹åˆ¥ã®è¨˜éŒ²ã‚’å‰Šé™¤ã™ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
    const deleteBtns = document.querySelectorAll('.deleteBtn');
    deleteBtns.forEach(btn => {
      btn.addEventListener('click', function() {
        const id = this.getAttribute('data-id');
        deleteHistoryItem(id);
      });
    });
  }

  function deleteHistoryItem(id) {
    if (confirm('ã“ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
      let history = JSON.parse(localStorage.getItem('chatHistory')) || [];
      history = history.filter(item => item.id != id);
      localStorage.setItem('chatHistory', JSON.stringify(history));
      displayHistory(); // å±¥æ­´ã‚’å†è¡¨ç¤º
    }
  }
});
</script>
</body>
</html>